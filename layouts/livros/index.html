{{- partial "htmlhead" . -}}
{{ $data := index .Site.Data .Site.Language.Lang }}

<body lang='{{ .Site.LanguageCode | default "en-us" }}' class="is-preload">

    <!-- Wrapper -->
    <div id="wrapper" class="fade-in">

        {{- partial "header" . -}}
        {{- partial "nav" . -}}

        <!-- Main -->
        <div id="main">
            <div id="livros"> 
                <div id="painelLivros">
                    <div class="arrow-holder">
                        <a id="carrousel-left"><i class="fa fa-chevron-left" aria-hidden="true"></i></a>
                    </div>

                    <div class='image-holder'>
                        {{ range $livro := .Params.livros }}
                        <div class="imagensPainelLivros"
                                id="painel-{{ $livro.id }}"
                                myid="{{ $livro.id }}"
                                titulo="{{ $livro.titulo }}"
                                numImagens="{{ len $livro.imagens }}"
                                imagens="{{ $livro.imagens }}"
                        >
                            <a href="#" class="container_livrostitulos">
                                <img src="{{ index $livro.imagens 0 }}" class="imagemPainel" alt="thumbnail da capa do livro">
                                <h4 class="titulolivros">{{ $livro.titulo }}</h4>
                            </a>
                        </div>
                        {{ end }}
                    </div>
                
                    <div class="arrow-holder">
                        <a id="carrousel-right"><i class="fa fa-chevron-right" aria-hidden="true"></i></a>
                    </div>
                </div>
            </div>
        
            <div id="paginaDoLivroSelecionado"></div>

            <div id="container_footerlivros">
                <div id="bookend">
                    <img src="/images/haqntopag/mybookshelf.svg" class="bookshelf" alt="a estante do autor, contendo vetores dos livros já escritos para ilustrar a cena">
                </div>

                {{ with $data.social }}
                    <section>
                        <ul class="icons alt">
                            {{ with .newsletter }}
                                <li><a href="{{ . }}" class="icon alt fa-envelope-open" target="_blank"><span class="label">Newsletter</span></a></li>
                            {{ end }}

                            {{ with .instagram}}
                                <li><a href="{{ . }}" class="icon alt fa-instagram" target="_blank"><span class="label">Instagram</span></a></li>
                            {{ end }}

                            {{ with .youtube }}
                                <li><a href="{{ . }}" class="icon fa-youtube-play" target="_blank"><span class="label">Youtube</span></a></li>
                            {{ end }}

                            {{ with .pinterest}}
                                <li><a href="{{ . }}" class="icon alt fa-pinterest" target="_blank"><span class="label">Pinterest</span></a></li>
                            {{ end }}
                        </ul>
                    </section>
                {{ end }} 
            </div>        
        </div>
        {{- partial "copyright" . }}
        <a href="#navPanel" id="navPanelToggle">{{ i18n "NAV_MENU" . }}</a>
    </div>

    <!-- BOTÕES COMPARTILHAR -->
    <div id="compartilharContainer">
        <div id='buttonCloseCompartilhar'><span class='fa fa-times' aria-hidden='true' onclick="closeCompartilharLivro()"></span></div>
        <div id="copyUrl_sharebutton"></div>
        <div id="wpp_sharebutton"> </div>
        <div id="twitter_sharebutton"></div>
        <div id="facebook_sharebutton"></div>
        <div id="reddit_sharebutton"></div>
        <div id="pinterest_sharebutton"></div>
    </div>
    <div id="urlCopiarNotification"></div>
    {{- template "_internal/google_analytics.html" . }}
    {{- partial "scripts/index" . }} 
    <!-- FIM BOTÕES COMPARTILHAR -->    
</body>

<style>
/* DEFINICOES GERAIS DE ESTILO */
    a {
        border: none;
    }

    form{
        display: inline-flex;
        margin: 0;
    }

    /* Carrossel horizontal com todos os livros */       
        img {
            display: block;
        }

        #livros {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .imagensPainelLivros{
            text-align: center;
        }

        .container_livrostitulos{
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .titulolivros{
            font-size: 1rem;
            font-weight: 600;
            margin: 0.5rem 0 0.5rem 0rem;
            letter-spacing: normal;
            text-align: center;
            width: 167px;
        }

        #painelLivros {
            display: inline-flex;
            flex-direction: row; 
            justify-content: space-between;
            padding-bottom: 2%;
            width: 95%;
            margin: auto;
            overflow: auto;
        }

        .selected{
            transform: scale(1.1);
        }

        .imagemPainel {
            max-width: 130px;
        }

        .image-holder {
            display: inline-flex;
            width: 100%;
            overflow-x: auto;
            overflow-y: hidden;
            margin-right: 35px;
            margin-left: 35px;
            padding-bottom: 10px;
            padding-top: 1%;
        }

        .image-holder >div:nth-last-child(1){
            margin-right:3%;
        }

        .image-holder >div:nth-child(1){
            margin-left:3%;
        }

        .imagensPainelLivros{
            margin-right: 5%;
        }

        .arrow-holder {
            align-self: center;
        }

        #carrousel-left, #carrousel-right{
            cursor:pointer;
            font-size: 40px;
            font-weight: bold;
            color: rgba(17, 17, 17, 0.89);
            user-select: none;
        }

        .imagemPainel{
            -webkit-backface-visibility: hidden;
            -webkit-transform: translateZ(0) scale(1, 1);
            filter: blur(0);
            -webkit-filter: blur(0);
            transition: transform .2s;
        }

        .imagemPainel:hover{
            transform: perspective(300px) rotateY(1deg) translateZ(10px) scale(0.97);
            transition: transform .2s;
        }

        #mySlidesID img{
            box-shadow: rgba(0, 0, 0, 0.33) 0px 1px 3px 0px;
            line-height: 0;
            object-fit: cover;
            width: 100%;
            max-height: 100%;
        }

/* Página do Livro Selecionado */
    #paginaDoLivroSelecionado{
        margin: 0;
        padding: 0;
    }
/* Fim da Página do Livro Selecionado */

/* Footer da página */ 
    #container_footerlivros>section{
        text-align: center;
    }

    #bookend{
        display: flex;
        flex-direction: row-reverse;
        border-bottom: 4px solid #3f4959;
        margin-bottom: 50px;
    }

    .bookshelf{
        width: 113px;
        margin-bottom: -7px;
        margin-right: 10px;
    }

/* DEFINICOES PARA OS TAMANHOS DE DEVICE MOBILE */
    /* Definicoes para retirar o clique de hover eterno dos mobiles */    
    @media only screen and (hover:none) and (pointer:coarse){       
        /*Fazer os botões voltarem ao normal*/        
        #prev:hover, #next:hover{
            color: rgba(255, 255, 255, 0.87) !important;
            opacity: 80%;
            background-color: rgba(255, 0, 0, 0);
        }
        #prev:active, #next:active{
            color:#18bfef !important;
        }
        #carrousel-left:hover, #carrousel-right:hover{
            color: rgba(17, 17, 17, 0.89) !important;
        }
        #carrousel-left:active, #carrousel-right:active{
            color:#18bfef !important;
        }
    }
</style>

<script type="text/javascript">
    // PÁGINA DO LIVRO SELECIONADO
    let atualizaPaginaDoLivro = function(){
        let paginaDoLivro = document.getElementById('paginaDoLivroSelecionado')
        if(currentFocus==0){ /* livro selecionado: Ha quanto tempo você não olha para as estrelas? */
            paginaDoLivro.innerHTML='{{- partial "livros_parciais/haqntotempo.html" . -}}'
            function loadjscssfile(haqntotempo, js){
                if (filetype=="js"){ //if filename is a external JavaScript file
                    var fileref=document.createElement('script')
                    fileref.setAttribute("type","text/javascript")
                    fileref.setAttribute("src", haqntotempo)
                }
            }
        }

        if(currentFocus!=0){ /* livro selecionado: Ha quanto tempo você não olha para as estrelas? */
            paginaDoLivro.innerHTML='{{ partial "livros_parciais/embreve.html" . }}'
        }
    }

    // CARROSSEL TODOS OS LIVROS
        let currentFocus = 0
        let images = document.getElementsByClassName('imagensPainelLivros')

        let setupCarousel = function() {
            for(let image of images) {
                image.addEventListener("click", (el) => {
                    el.preventDefault()
                    el.currentTarget.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' })
                    images[currentFocus].classList.remove('selected')
                    currentFocus = parseInt(el.currentTarget.getAttribute('myid'))
                    el.currentTarget.classList.add('selected')
                    atualizaPaginaDoLivro();
                })
            }
        }

        document.getElementById('carrousel-left').addEventListener("click", () => {
            currentFocus = currentFocus > 0 ? currentFocus - 1 : images.length - 1
            images[currentFocus].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' })
            })

        document.getElementById('carrousel-right').addEventListener("click", () => {
            currentFocus = currentFocus < images.length - 1 ? currentFocus + 1 : 0
            images[currentFocus].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' })
        })

        document.addEventListener("DOMContentLoaded", (event) => { 
            setupCarousel()
            images[0].click()
        });
    // FIM CARROSSEL TODOS OS LIVROS
</script>